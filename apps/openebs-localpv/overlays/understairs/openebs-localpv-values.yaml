---
# Disable all engines except rawfile
#
# NOTE: The rawfile DaemonSet runs on all nodes including control-plane.
# This is acceptable because volumeBindingMode: WaitForFirstConsumer ensures
# PVCs only provision on nodes where workloads schedule (i.e., workers).
# If control-plane resource usage becomes a concern with more nodes, consider
# adding nodeSelector support upstream or using StorageClass allowedTopologies
# with explicit worker node labels.
engines:
  local:
    lvm:
      enabled: false
    zfs:
      enabled: false
    rawfile:
      enabled: true
  replicated:
    mayastor:
      enabled: false

# Disable monitoring stack (using centralized Grafana Alloy instead)
alloy:
  enabled: false
loki:
  enabled: false

# Rawfile-specific configuration for Talos
rawfile-localpv:
  rawfileNode:
    kubeletDir: /var/lib/kubelet
  rawfileController:
    tolerations:
      - key: node-role.kubernetes.io/control-plane
        operator: Exists
        effect: NoSchedule
  rawfilePlugin:
    tolerations:
      - key: node-role.kubernetes.io/control-plane
        operator: Exists
        effect: NoSchedule
